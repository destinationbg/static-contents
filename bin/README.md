## Въведение

Това хранилище съдържа Python скриптове, с които официалните [ЕКАТТЕ данни](https://www.nsi.bg/nrnm/ekatte/index) от сайта на **Националния статистически институт** могат да се преобразуват във формат, с който destination.bg оперира.

За целта са свалени копия на три файла и са съхранени в папката `data`:
- `ek_obl.json` - съдържа всички области;
- `ek_obst.json` - съдържа всички общини;
- `ek_atte.json` - съдържа всички градове и села.

В допълнение там се съхранява и файл, който понастоящем няма от къде да бъде свален и генериран, а именно `municipalities_by_region.json`, който е ръчно генериран от мен. Файлът съдържа списък с всички официални [туристически райони на страната](https://www.tourism.government.bg/bg/kategorii/strategicheski-dokumenti/koncepciya-za-turistichesko-rayonirane-na-bulgariya) след решението на **Министерство на туризма** за туристическо райониране на България, както и общините, които попадат в територията на всеки от районите.

## Как се използва?

Изпълнявайки наличните Python скриптове с имена `step1.py`, `step2.py` и `step3.py` може да генерирате данни, подходящи за употреба в средата на destination.bg проекта.

Команди за стартиране на скриптовете:

```bash
python3 step1.py
python3 step2.py
python3 step3.py
```

### Файл "step1.py"

Този файл преобразува областите в индивидуални YAML файлове, където стойностите на `slug` и `code` се използват, за да се даде уникално име на генерирания файл (например `blagoevgrad-blg.yml`). Генерираните файлове се съхраняват в новосъздадена папкa с име `1.provinces`.

#### Детайли

- `ekatte` отговаря за идентификационният код на териториалната единица (ЕКАТТЕ-код), който се състои от 4+1 цифри, където последната цифра е контролна;
- `code` отговаря за идентификационният код на областта (3 букви) според спецификациите на ЕКАТТЕ.

#### Примерно съдържание

```yml
# файл blagoevgrad-blg.yml

slug: blagoevgrad
ekatte: 04279
code: BLG
locale:
  bg:
    name: Област Благоевград
    description: '...'
  en:
    name: Blagoevgrad Province
    description: '...'
```

### Файл "step2.py"

Този файл преобразува общините в индивидуални YAML файлове, където стойностите на `slug` и `code` се използват, за да се даде уникално име на генерирания файл (например `aksakovo-var02.yml`). Генерираните файлове се съхраняват в новосъздадена папкa с име `2.municipalities`.

#### Детайли

- `ekatte` отговаря за идентификационният код на териториалната единица (ЕКАТТЕ-код), който се състои от 4+1 цифри, където последната цифра е контролна;
- `code` отговаря за идентификационният код на общината, в чийто състав влиза териториалната единица (5 знака; първите 3 букви са кода на областта; следващите 2 цифри са пореден номер на общината в областта) според спецификациите на ЕКАТТЕ;
- `region` се взима от файла `municipalities_by_region.json`, който споменах в началото;
- освен стандартното преобразуване от един формат в друг, в Python скрипта също така е добавен и специален mapping за случаите, в които едно име се среща повече от веднъж, за да се избегне дублиране и неправилно съхранение на генерираните файлове.

#### Примерно съдържание

```yml
# файл aksakovo-var02.yml

slug: aksakovo
ekatte: 00182
code: VAR02
locale:
  bg:
    name: Община Аксаково
    description: '...'
  en:
    name: Aksakovo Municipality
    description: '...'
region: varna-black-sea
```

### Файл "step3.py"

Този файл преобразува градовете и селата в индивидуални YAML файлове, където стойностите на `slug` и `code` се използват, за да се даде уникално име на генерирания файл (например `aheloy-bgs17.yml` и `ablanitsa-blg52.yml`). Генерираните файлове се съхраняват в новосъздадени папки с имена `3.cities` (за градовете) и `4.villages` (за селата).

#### Детайли

- `ekatte` отговаря за идентификационният код на териториалната единица (ЕКАТТЕ-код), който се състои от 4+1 цифри, където последната цифра е контролна;
- `code` отговаря за идентификационният код на общината, в чийто състав влиза териториалната единица (5 знака; първите 3 букви са кода на областта; следващите 2 цифри са пореден номер на общината в областта) според спецификациите на ЕКАТТЕ;
- освен стандартното преобразуване от един формат в друг, в Python скрипта също така е добавен и специален mapping за случаите, в които едно име се среща повече от веднъж, за да се избегне дублиране и неправилно съхранение на генерираните файлове.

#### Примерно съдържание за град

```yml
# файл aheloy-bgs17.yml

slug: aheloy
ekatte: 00833
code: BGS17
locale:
  bg:
    name: Град Ахелой
    description: '...'
  en:
    name: Aheloy City
    description: '...'
```

#### Примерно съдържание за село

```yml
# файл ablanitsa-blg52.yml

slug: ablanitsa
ekatte: '00014'
code: BLG52
locale:
  bg:
    name: Село Абланица
    description: '...'
  en:
    name: Ablanitsa Village
    description: '...'
```
